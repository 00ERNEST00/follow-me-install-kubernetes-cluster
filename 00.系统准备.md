[root@test-105 ~]# cat /etc/hostname
kube-node1
[root@test-105 ~]# cat /etc/sysconfig/network
NETWORKING=yes
HOSTNMAE=kube-node1
[root@kube-node1 ~]# grep kube /etc/hosts
172.27.129.80 kube-node1 kube-node1
172.27.129.81 kube-node2 kube-node2
172.27.129.82 kube-node3 kube-node3

[root@kube-node1 ~]# systemctl stop firewalld
[root@kube-node1 ~]# systemctl disable firewalld
[root@kube-node1 ~]# yum install -y epel-release
[root@localhost ~]# yum install -y vim go conntrack ipvsadm ipset jq sysstat curl iptables

[root@localhost ~]# useradd -m k8s
[root@localhost ~]# visudo
[root@test-105 ~]# grep '%wheel.*NOPASSWD: ALL' /etc/sudoers
%wheel	ALL=(ALL)	NOPASSWD: ALL
[root@localhost ~]# gpasswd -a k8s wheel
[root@localhost ~]# gpasswd -a k8s wheel

[root@localhost ~]# mkdir -p /opt/k8s/bin
[root@localhost ~]# chown -R k8s /opt/k8s
[root@localhost ~]# vim /etc/profile
[root@localhost ~]# grep k8s /etc/profile
PATH=/opt/k8s/bin:$PATH:$HOME/bin:$JAVA_HOME/bin
[root@localhost ~]# su -l k8s
[k8s@kube-node1 k8s]$ source /etc/profile

[root@kube-node1 ~]# useradd -m docker
[root@kube-node1 ~]# gpasswd -a k8s docker
[root@kube-node1 ~]# mkdir -p  /etc/docker/
[root@kube-node1 ~]# cat /etc/docker/daemon.json
{
    "registry-mirrors": ["https://hub-mirror.c.163.com", "https://docker.mirrors.ustc.edu.cn"],
    "insecure-registries": ["docker02:35000"],
    "max-concurrent-downloads": 20
}

 ``` bash
  [k8s@kube-node1 k8s]$ sudo iptables -P FORWARD ACCEPT
  [k8s@kube-node1 k8s]$
  ```
  并且把以下命令写入/etc/rc.local文件中，防止节点重启**iptables FORWARD chain的默认策略又还原为DROP**
  
  ``` bash
  sleep 60 && /sbin/iptables -P FORWARD ACCEPT
  ```


+ 为了加快 pull image 的速度，可以使用国内的仓库镜像服务器，同时增加下载的并发数。(如果 dockerd 已经运行，则需要重启 dockerd 生效。)

    ``` bash
    [k8s@kube-node1 k8s]$ sudo mkdir -p  /etc/docker/
    [k8s@kube-node1 k8s]$ cat /etc/docker/daemon.json
    {
        "registry-mirrors": ["https://hub-mirror.c.163.com", "https://docker.mirrors.ustc.edu.cn"],
        "max-concurrent-downloads": 20
    }
    ```
    

[root@kube-node1 ~]# sudo mkdir -p /etc/kubernetes/ssl
[root@kube-node1 ~]# chown -R k8s /etc/kubernetes


[root@kube-node1 ~]# mkdir -p /etc/etcd/ssl
[root@kube-node1 ~]# chown -R k8s /etc/etcd/ssl

[root@kube-node1 ~]# mkdir -p /var/lib/etcd && chown -R k8s /etc/etcd/ssl


[k8s@kube-node1 k8s]$ ssh-keygen -t rsa
[k8s@kube-node1 k8s]$ ssh-copy-id root@kube-node1
[k8s@kube-node1 k8s]$ ssh-copy-id root@kube-node2
[k8s@kube-node1 k8s]$ ssh-copy-id root@kube-node3

[k8s@kube-node1 k8s]$ ssh-copy-id k8s@kube-node1
[k8s@kube-node1 k8s]$ ssh-copy-id k8s@kube-node2
[k8s@kube-node1 k8s]$ ssh-copy-id k8s@kube-node3